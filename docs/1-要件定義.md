# 要件定義

### 1. ドキュメント情報

- **ドキュメント名**：お年玉トラッカー＆目標設定シミュレーター 要件定義書
- **作成日**：2025/12/16
- **作成者**：開発チーム（4名）
- **バージョン履歴**：v1.0

---

### 2. プロジェクト概要

- **システム名**：👑お年玉トラッカー＆目標設定シミュレーター
- **システムの目的・背景**：
    - お年玉は **一度にまとまったお金が入る**
    - 子どもは
        - いくらもらったか覚えていない
        - すぐ使ってしまう
        - 「貯金・投資」という考え方に触れる機会が少ない
    - 親も
        - 使い道を細かく管理したくない
        - でも「学び」にはつなげたい
    
    👉 **お金の使い方を“体験として学べる仕組み”が欲しい**
    
- **関係者**：
    - 開発チーム：チームB

---

### 3. 用語定義

| 用語 | 定義 |
| --- | --- |
| 例：CV | コンバージョンの略 |

---

### 4. 業務フロー（As-Is / To-Be）

- **現在の業務（As-Is）**：
- **新システムでの業務フロー（To-Be）**：
- （必要に応じてフローチャートをNotionに貼り付け）

---

### 5. 機能要件

| ID | 機能名 | 概要 | 詳細仕様 |
| --- | --- | --- | --- |
| FR-001 | 残高照会 | ユーザーが保有する口座の残高情報を照会できる | ・残高照会APIを呼び出す
・口座ごとの残高を画面に表示 |
| FR-002 | 口座一覧照会 | ユーザーが保有する全ての口座情報一覧を照会できる | ・口座一覧照会APIを使用
・円普通預金口座およびつかいわけ口座を表示 |
| FR-003 | つかいわけ口座間振替 | ユーザーがつかいわけ口座間で振替指示を行える | ・つかいわけ口座間振替APIを使用
・振替元／振替先口座を選択可能
・金額入力後、確認画面を表示
・振替結果を画面に表示 |
| FR-004 | 入出金明細照会 | 指定した円普通預金口座の入出金明細情報を照会できる | ・入出金明細照会APIを使用
・入金／出金を区別して一覧表示 |

---

### 6. 非機能要件

| 項目 | 内容 |
| --- | --- |
| パフォーマンス | 応答時間1秒以内（95%以上） |
| 可用性 | 月間稼働率99.9%以上 |
| セキュリティ | TLS対応、OWASP Top10対策 |
| 対応端末 | Chrome, Safari（最新2バージョン） |

---

### 7. 画面一覧・仕様

| 画面ID | 画面名 | 概要 | 遷移元 | 遷移先 |
| --- | --- | --- | --- | --- |
| UI-001 | ダッシュボード画面 | 銀行残高の確認、金額振り分け、入出金明細の閲覧を1画面で行う | なし（初期表示 | なし |

> ✅ 入力項目、バリデーション条件、ボタン配置なども別途記載 or ワイヤーフレーム添付
> 

---

### 8. データ要件（データベースは使用しない！）

- 主なデータ項目と型
- マスターデータ（例：ユーザー権限、カテゴリ一覧）
- 保存期間、整合性ルール

---

### 9. 外部連携・API要件

| 外部サービス | 概要 | 方法 | 形式 |
| --- | --- | --- | --- |
| sunabarGMOあおぞら銀行） | 口座情報の参照および振替処理 | 残高照会API
口座一覧照会API
入出金明細照会API
つかいわけ口座間振替API | JSON |

---

### 10. 制約事項・前提条件

- 利用技術スタック：

フロントエンド

- **Next.js**
- **TypeScript**
- **Tailwind CSS**
- **fetch or TanStack Query（余裕があれば）**

バックエンド

- **Node.js + Express**
- **TypeScript**
- **axios（銀行API呼び出し用）**
- **dotenv（環境変数）**
- 社内制約（VPN内など）
- 環境前提　開発環境：バックエンドはDocker使用、フロントエンドはローカル

---

### 11. リスクと対応方針

### ① 銀行APIキー漏洩リスク（最重要）

### リスク内容

- APIキーが漏れると第三者に不正利用される
- 金融系アプリとして致命的

### 対応方針

- 銀行APIは**バックエンド（sunabar）からのみ呼び出す**
- APIキーは `.env`／sunabar環境変数で管理
- フロントエンドには一切持たせない
- `.env` は Git 管理外（`.gitignore`）

---

### ② フロントからの不正リクエストリスク

### リスク内容

- 想定外のパラメータを送られる
- 不正な割合（合計100%超など）を指定される

### 対応方針

- バックエンドで入力値を検証
    - 数値かどうか
    - 合計が100%か
- フロントの入力チェック＋バックの二重チェック

---

### ③ 銀行API障害・通信失敗リスク

### リスク内容

- 銀行APIが落ちている
- タイムアウト・レスポンス遅延

### 対応方針

- アプリが落ちないよう try-catch で制御

```tsx
try {
// 銀行API呼び出し
}catch {
  res.status(500).json({message:"取得に失敗しました" });
}
```